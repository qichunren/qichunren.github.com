<html>
  <head>
    <meta content='初试Rails 3.1 Beta - 蕲春人的博客' property='og:title' />
    <title>初试Rails 3.1 Beta - 蕲春人的博客</title>
    <link href='/images/fav.png' rel='shortcut icon'>
<link href='/stylesheets/style.css' rel='stylesheet' type='text/css' />
<link href='/stylesheets/syntax.css' rel='stylesheet' type='text/css' />
<link href='/stylesheets/responsive.css' rel='stylesheet' type='text/css' />
<!-- - -->
<script src='/javascripts/jquery.js' type='text/javascript'></script>
<script src='/javascripts/pd.js' type='text/javascript'></script>
<script src='/javascripts/basics.js' type='text/javascript'></script>
<!--<script type="text/javascript" src="https://www.google.com/jsapi"></script>-->
<!-- - -->
<meta content='width=device-width, initial-scale=1.0, user-scalable=no' name='viewport'>
<meta content='text/html; charset=utf-8' http-equiv='content-type' />
<meta content="http://muan.co/images/og.png" property="og:image" />
<meta content="" property="fb:app_id" />

  <meta content='/2011/05/05/try_rails_31_beta/' property='og:url' />
  <meta content="看到[消息](http://weblog.rubyonrails.org/2011/5/5/rails-3-1-beta-1-released) 说Rails3.1 Beta出来了，我立刻就想试试，先从大体上了解一下看做了哪些改变。`..." property='og:description' />
  <meta content="article" property="og:type" />

<!-- - -->
<script type='text/javascript'>
  //<![CDATA[
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-6344646-4']);
    _gaq.push(['_trackPageview']);
    
    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  //]]>
</script>

  </head>
  <body>
    <header>
<p>蕲春人的博客</p>
</header>
    <div id='container'>
      <div class="block">
  
    <a target="_top" class="main" href="/about">About</a>
  
    <a target="_blank" class="main" href="http://qichunren.github.io">Blog</a>
  
    <a target="_blank" class="main" href="mailto:whyruby@gmail.com">Email</a>
  
    <a target="_blank" class="main" href="http://github.com/qichunren">GitHub</a>
  
</div>
      <section class="paging">
  
    <div class="left">
      <a href="/2011/05/04/export_data_to_excel_in_rails/">
        ‹
      </a>
    </div>
  
  
    <div class="right">
      <a href="/ruby/tool/2011/05/04/use_feedzirra_to_fetch_feed/">
        ›
      </a>
    </div>
  
</section>
      <div class="content">
        <section class='post'>
          <h1 class="upcase">
            <div class='date'>05 May 2011</div>
            初试Rails 3.1 Beta
          </h1>
          <p>看到<a href="http://weblog.rubyonrails.org/2011/5/5/rails-3-1-beta-1-released">消息</a> 说Rails3.1 Beta出来了，我立刻就想试试，先从大体上了解一下看做了哪些改变。
<code>
usermatoMacBook-Pro:code qichunren$ rvm use 1.9.2
Using /Users/qichunren/.rvm/gems/ruby-1.9.2-p0
usermatoMacBook-Pro:jjsc_web_backend qichunren$ gem install rails --pre
Successfully installed multi_json-1.0.1
Successfully installed activesupport-3.1.0.beta1
Successfully installed i18n-0.6.0beta1
Successfully installed activemodel-3.1.0.beta1
Successfully installed rack-1.3.0.beta
Successfully installed rack-cache-1.0.1
Successfully installed rack-test-0.6.0
Successfully installed rack-mount-0.7.2
Successfully installed hike-1.0.0
Successfully installed sprockets-2.0.0.beta.2
Successfully installed tzinfo-0.3.27
Successfully installed erubis-2.7.0
Successfully installed actionpack-3.1.0.beta1
Successfully installed arel-2.1.0
Successfully installed activerecord-3.1.0.beta1
Successfully installed activeresource-3.1.0.beta1
Successfully installed mail-2.3.0
Successfully installed actionmailer-3.1.0.beta1
Successfully installed rack-ssl-1.3.2
Successfully installed railties-3.1.0.beta1
Successfully installed rails-3.1.0.beta1
21 gems installed
Installing ri documentation for multi_json-1.0.1...
Building YARD (yri) index for multi_json-1.0.1...
Installing ri documentation for activesupport-3.1.0.beta1...
Building YARD (yri) index for activesupport-3.1.0.beta1...
Installing ri documentation for i18n-0.6.0beta1...
Building YARD (yri) index for i18n-0.6.0beta1...
Installing ri documentation for activemodel-3.1.0.beta1...
Building YARD (yri) index for activemodel-3.1.0.beta1...
Installing ri documentation for rack-1.3.0.beta...
Building YARD (yri) index for rack-1.3.0.beta...
Installing ri documentation for rack-cache-1.0.1...
Building YARD (yri) index for rack-cache-1.0.1...
Installing ri documentation for rack-test-0.6.0...
Building YARD (yri) index for rack-test-0.6.0...
Installing ri documentation for rack-mount-0.7.2...
Building YARD (yri) index for rack-mount-0.7.2...
Installing ri documentation for hike-1.0.0...
Building YARD (yri) index for hike-1.0.0...
Installing ri documentation for sprockets-2.0.0.beta.2...
Building YARD (yri) index for sprockets-2.0.0.beta.2...
Installing ri documentation for tzinfo-0.3.27...
Building YARD (yri) index for tzinfo-0.3.27...
Installing ri documentation for erubis-2.7.0...
Building YARD (yri) index for erubis-2.7.0...
Installing ri documentation for actionpack-3.1.0.beta1...
Building YARD (yri) index for actionpack-3.1.0.beta1...
Building YARD (yri) index for arel-2.1.0...
Installing ri documentation for activerecord-3.1.0.beta1...
Building YARD (yri) index for activerecord-3.1.0.beta1...
Installing ri documentation for activeresource-3.1.0.beta1...
Building YARD (yri) index for activeresource-3.1.0.beta1...
Installing ri documentation for mail-2.3.0...
Building YARD (yri) index for mail-2.3.0...
Installing ri documentation for actionmailer-3.1.0.beta1...
Building YARD (yri) index for actionmailer-3.1.0.beta1...
Installing ri documentation for rack-ssl-1.3.2...
Building YARD (yri) index for rack-ssl-1.3.2...
Installing ri documentation for railties-3.1.0.beta1...
Building YARD (yri) index for railties-3.1.0.beta1...
Installing ri documentation for rails-3.1.0.beta1...
file &#39;lib&#39; not found
Building YARD (yri) index for rails-3.1.0.beta1...
Installing RDoc documentation for multi_json-1.0.1...
Installing RDoc documentation for activesupport-3.1.0.beta1...
Installing RDoc documentation for i18n-0.6.0beta1...
Installing RDoc documentation for activemodel-3.1.0.beta1...
Installing RDoc documentation for rack-1.3.0.beta...
Installing RDoc documentation for rack-cache-1.0.1...
Installing RDoc documentation for rack-test-0.6.0...
Installing RDoc documentation for rack-mount-0.7.2...
Installing RDoc documentation for hike-1.0.0...
Installing RDoc documentation for sprockets-2.0.0.beta.2...
Installing RDoc documentation for tzinfo-0.3.27...
Installing RDoc documentation for erubis-2.7.0...
Installing RDoc documentation for actionpack-3.1.0.beta1...
Installing RDoc documentation for activerecord-3.1.0.beta1...
Installing RDoc documentation for activeresource-3.1.0.beta1...
Installing RDoc documentation for mail-2.3.0...
Installing RDoc documentation for actionmailer-3.1.0.beta1...
Installing RDoc documentation for rack-ssl-1.3.2...
Installing RDoc documentation for railties-3.1.0.beta1...
Installing RDoc documentation for rails-3.1.0.beta1...
file &#39;lib&#39; not found
usermatoMacBook-Pro:code qichunren$ rails -v
Rails 3.1.0.beta1
</code></p>

<p>看看rails命令有没有一些改动：
&ldquo;`
usermatoMacBook-Pro:code qichunren$ rails &ndash;help
Usage:
  rails new APP_PATH [options]</p>

<p>Options:
  -r, [&ndash;ruby=PATH]              # Path to the Ruby binary of your choice
                                 # Default: /Users/qichunren/.rvm/rubies/ruby-1.9.2-p0/bin/ruby
  -b, [&ndash;builder=BUILDER]        # Path to a application builder (can be a filesystem path or URL)
  -m, [&ndash;template=TEMPLATE]      # Path to an application template (can be a filesystem path or URL)
      [&ndash;skip-gemfile]           # Don&rsquo;t create a Gemfile
  -G, [&ndash;skip-git]               # Skip Git ignores and keeps
  -O, [&ndash;skip-active-record]     # Skip Active Record files
  -d, [&ndash;database=DATABASE]      # Preconfigure for selected database (options: mysql/oracle/postgresql/sqlite3/frontbase/ibm_db/jdbcmysql/jdbcsqlite3/jdbcpostgresql)
                                 # Default: sqlite3
  -j, [&ndash;javascript=JAVASCRIPT]  # Preconfigure for selected JavaScript library
                                 # Default: jquery
  -J, [&ndash;skip-javascript]        # Skip JavaScript files
      [&ndash;dev]                    # Setup the application with Gemfile pointing to your Rails checkout
      [&ndash;edge]                   # Setup the application with Gemfile pointing to Rails repository
  -T, [&ndash;skip-test-unit]         # Skip Test::Unit files
      [&ndash;old-style-hash]         # Force using old style hash (:foo =&gt; &lsquo;bar&rsquo;) on Ruby &gt;= 1.9</p>

<p>Runtime options:
  -f, [&ndash;force]    # Overwrite files that already exist
  -p, [&ndash;pretend]  # Run but do not make any changes
  -q, [&ndash;quiet]    # Supress status output
  -s, [&ndash;skip]     # Skip files that already exist</p>

<p>Rails options:
  -h, [&ndash;help]     # Show this help message and quit
  -v, [&ndash;version]  # Show Rails version number and quit</p>

<p>Description:
    The &lsquo;rails new&rsquo; command creates a new Rails application with a default
    directory structure and configuration at the path you specify.</p>

<p>Example:
    rails new ~/Code/Ruby/weblog</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">This generates a skeletal Rails installation in ~/Code/Ruby/weblog.
See the README in the newly created application to get going.
</code></pre></div>
<p>usermatoMacBook-Pro:code qichunren$
&rdquo;`</p>

<p>继续建立一个新项目
<code>
usermatoMacBook-Pro:code qichunren$ rails new rails3
      create
      create  README
      create  Rakefile
      create  config.ru
      create  .gitignore
      create  Gemfile
      create  app
      create  app/assets/images/rails.png
      create  app/assets/javascripts/application.js
      create  app/assets/stylesheets/application.css
      create  app/controllers/application_controller.rb
      create  app/helpers/application_helper.rb
      create  app/mailers
      create  app/models
      create  app/views/layouts/application.html.erb
      create  app/mailers/.gitkeep
      create  app/models/.gitkeep
      create  config
      create  config/routes.rb
      create  config/application.rb
      create  config/environment.rb
      create  config/environments
      create  config/environments/development.rb
      create  config/environments/production.rb
      create  config/environments/test.rb
      create  config/initializers
      create  config/initializers/backtrace_silencers.rb
      create  config/initializers/inflections.rb
      create  config/initializers/mime_types.rb
      create  config/initializers/secret_token.rb
      create  config/initializers/session_store.rb
      create  config/initializers/wrap_parameters.rb
      create  config/locales
      create  config/locales/en.yml
      create  config/boot.rb
      create  config/database.yml
      create  db
      create  db/seeds.rb
      create  doc
      create  doc/README_FOR_APP
      create  lib
      create  lib/tasks
      create  lib/tasks/.gitkeep
      create  log
      create  log/.gitkeep
      create  public
      create  public/404.html
      create  public/422.html
      create  public/500.html
      create  public/favicon.ico
      create  public/index.html
      create  public/robots.txt
      create  script
      create  script/rails
      create  test/fixtures
      create  test/fixtures/.gitkeep
      create  test/functional
      create  test/functional/.gitkeep
      create  test/integration
      create  test/integration/.gitkeep
      create  test/unit
      create  test/unit/.gitkeep
      create  test/performance/browsing_test.rb
      create  test/test_helper.rb
      create  tmp/cache
      create  tmp/cache/.gitkeep
      create  vendor/assets/stylesheets
      create  vendor/assets/stylesheets/.gitkeep
      create  vendor/plugins
      create  vendor/plugins/.gitkeep
usermatoMacBook-Pro:code qichunren$
</code></p>

<p>创建一个scaffold user后，发现在页面里/assets/application.js中包括了jQuery 1.6，还有rails.js for jquery这个。再也不需要之前的那个手工引入jQuery了，或者使用jquery-rails这个gem.
另外还生成有一个/assets/user.js.coffee文件，得要花时间学一下这个<a href="https://github.com/jashkenas/coffee-script">coffee-script</a>了。</p>

<p>还发现一个有趣的现象，rails团队似乎偏爱json,在scaffold生成的代码中没有了以前的xml format</p>

<div class="highlight"><pre><code class="ruby"><span class="k">def</span> <span class="nf">index</span>
  <span class="vi">@users</span> <span class="o">=</span> <span class="no">User</span><span class="o">.</span><span class="n">all</span>

  <span class="n">respond_to</span> <span class="k">do</span> <span class="o">|</span><span class="nb">format</span><span class="o">|</span>
    <span class="nb">format</span><span class="o">.</span><span class="n">html</span> <span class="c1"># index.html.erb</span>
    <span class="nb">format</span><span class="o">.</span><span class="n">json</span> <span class="p">{</span> <span class="n">render</span> <span class="ss">json</span><span class="p">:</span> <span class="vi">@users</span> <span class="p">}</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div>

<p>另外多了一个assets的generator:
&ldquo;<code>
Example:
</code>rails generate assets posts`</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">Posts assets.
    Javascript:     app/assets/javascripts/posts.js
    Stylesheet:     app/assets/stylesheets/posts.css
</code></pre></div><div class="highlight"><pre><code class="text language-text" data-lang="text">总体上看，变化不大，将jQuery，coffee_script,scss加入默认了。一切都继续演进。
</code></pre></div>
          <br />
<p>
  蕲春人
  <span class="muted">at 00:00</span>
</p>
<p>
  <img src="/images/scribble3.png" alt="scribble" />
</p>


        </section>
      </div>
      

      
      <div class="block">
  
    <a target="_top" class="main" href="/about">About</a>
  
    <a target="_blank" class="main" href="http://qichunren.github.io">Blog</a>
  
    <a target="_blank" class="main" href="mailto:whyruby@gmail.com">Email</a>
  
    <a target="_blank" class="main" href="http://github.com/qichunren">GitHub</a>
  
</div>
    </div>
    <footer>
  <a href="http://github.com/muan/scribble" class="muted">built with Jekyll using Scribble theme</a>
</footer>
  </body>
</html>
